<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FinTrack - Dashboard</title>
  <link rel="stylesheet" href="vvvg.css">
   <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="hamburgr.css">
  <link rel = "stylesheet" href = "dash.css"></link>
  <!-- <link rel="stylesheet" href="backgroundstyle.css"> -->
</head>
<body>
  <div class="hamburger-menu">
    <div class="bar"></div>
    <div class="bar"></div>
    <div class="bar"></div>
  </div>
  
  <div class="sidebar-overlay"></div>
  
  <div class="sidebar">
    <div class="sidebar-header">
      <h3>Menu</h3>
      <div class="close-btn">&times;</div>
    </div>
    <div class="sidebar-content">
      <a href="#">Home</a>
      <a href="signin.html" id = "auth-link" style = "display: none;"class="nav-link">Sign In</a>
      <a href="#">Dashboard</a>
      
      
      <a href="#">Learn More</a>
      <a href="#">Contact us</a>
      <a href="#" id = "logout-btn" style = "display: none;" class="nav-link" onclick="logout()">Log Out</a>
    </div>
  </div>
  <script src="hmg.js"></script>
  <nav class="nav">
    <div class="logo">FinTrack</div>
    <div class="nav-links">
      <a href="index.html" class="nav-link">Home</a>
      <a href="LearnMore.html" class="nav-link">Learn More</a>
      <a href="#" class="nav-link active">Dashboard</a>
      <a href="signin.html" id = "logout-btn" class="nav-link">Sign Out</a>
    </div>
  </nav>
  <script src = "auth.js"></script>
  <section class="dashboard-container">
    <div class="dashboard-header">
      <h1>Your Financial Dashboard</h1>
      <p class="subtitle">Welcome back, User! Here's your financial overview.</p>
    </div>

    <div class="dashboard-summary">
      <div class="summary-card">
        <h3>Total Balance</h3>
        <p class="amount">$5,280.45</p>
        <p class="trend positive">â†‘ 8.3% from last month</p>
      </div>
      <div class="summary-card">
        <h3>Monthly Income</h3>
        <p class="amount">$3,750.00</p>
        <p class="trend neutral">â€• Same as last month</p>
      </div>
      <div class="summary-card">
        <h3>Monthly Expenses</h3>
        <p class="amount">$2,138.75</p>
        <p class="trend negative">â†‘ 12.6% from last month</p>
      </div>
      <div class="summary-card">
        <h3>Savings Rate</h3>
        <p class="amount">43%</p>
        <p class="trend negative">â†“ 5% from last month</p>
      </div>
    </div>



    <div class="dashboard-row">
      <div class="chart-container half">
        <div class="chart-header">
          <h3>Expense Breakdown</h3>
        </div>
        <div class="card">
                <h2 class="card-title">Spending by Category</h2>
                <div class="chart-container">
                    <canvas id="category-chart"></canvas>
                </div>
            </div>
      </div>
    </div>
<div class="dashboard-row">
    <div class="reminders-container half">
        <div class="container-header">
            <h3>Upcoming Bills</h3>
        </div>
        <div class="reminders-list">
            <!-- Bills will be dynamically inserted here by JavaScript -->
            <p>Loading upcoming bills...</p>
        </div>
    </div>
</div>
    <!-- New buttons section after upcoming bills -->
    <div class="dashboard-row feature-buttons">
      <button class="feature-btn bill-btn">
        <span class="btn-icon">ðŸ“…</span>
        <span class="btn-text">Bills & Notifications</span>
      </button>
      <button class="feature-btn chatbot-btn">
        <span class="btn-icon">ðŸ’¬</span>
        <span class="btn-text">Finance Assistant</span>
      </button>
      <button class="feature-btn transaction-btn">
        <span class="btn-icon">ðŸ’°</span>
        <span class="btn-text">Transactions</span>
      </button>
    </div>

  </section>

  <footer class="footer">
    <div class="footer-content">
      <div class="footer-column">
        <h4>Product</h4>
        <ul>
          <li><a href="#">Features</a></li>
          <li><a href="#">Pricing</a></li>
          <li><a href="#">Mobile App</a></li>
          <li><a href="#">Browser Extension</a></li>
          <li><a href="#">Roadmap</a></li>
        </ul>
      </div>
      
      <div class="footer-column">
        <h4>Company</h4>
        <ul>
          <li><a href="#">About Us</a></li>
          <li><a href="#">Careers</a></li>
          <li><a href="#">Press Kit</a></li>
          <li><a href="#">Blog</a></li>
          <li><a href="#">Contact</a></li>
        </ul>
      </div>
      
      <div class="footer-column">
        <h4>Resources</h4>
        <ul>
          <li><a href="#">Help Center</a></li>
          <li><a href="#">Community</a></li>
          <li><a href="#">Financial Guides</a></li>
          <li><a href="#">API Documentation</a></li>
          <li><a href="#">Security</a></li>
        </ul>
      </div>
      
      <div class="footer-column">
        <h4>Connect With Us</h4>
        <p>Subscribe to our newsletter for tips, updates, and financial wisdom.</p>
        <div class="social-icons">
          <a href="#" class="social-icon">X</a>
          <a href="#" class="social-icon">F</a>
          <a href="#" class="social-icon">I</a>
          <a href="#" class="social-icon">L</a>
        </div>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>Â© 2025 FinTrack. All rights reserved.</p>
      <p style="margin-top: 8px;">
        <a href="#" style="margin-right: 16px;">Privacy Policy</a>
        <a href="#" style="margin-right: 16px;">Terms of Service</a>
        <a href="#">Cookie Settings</a>
      </p>
    </div>
  </footer>
 <script>
document.addEventListener("DOMContentLoaded", async function () {
    let transactions = [];

    async function fetchTransactions() {
        try {
            const response = await fetch("https://my-backend-api-erp6.onrender.com/api/get-transactions", {
                method: "GET",
                headers: {
                    "Content-Type": "application/json",
                },
            });

            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }

            transactions = await response.json();
            updateChart(); // Call updateChart only after data is fetched
        } catch (error) {
            console.error("Error fetching transactions:", error);
        }
    }

    // Get the canvas element
    const canvas = document.getElementById("category-chart");
    if (!canvas) {
        console.error("Canvas element for category-chart not found!");
        return;
    }

    const ctx = canvas.getContext("2d");

    // Create Chart.js pie chart
    let categoryChart = new Chart(ctx, {
        type: "pie",
        data: {
            labels: [],
            datasets: [
                {
                    data: [],
                    backgroundColor: [
                        "#0066cc", "#0080ff", "#66b3ff", "#2997ff", "#0056b3",
                        "#e0e0e0", "#86868b", "#6c757d", "#003366", "#002b4d"
                    ],
                    borderWidth: 1
                }
            ]
        },
      
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: "right",
                    labels: {
                        boxWidth: 12,
                        font: { size: 11 }
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function (context) {
                            return `${context.label}: $${context.raw.toFixed(2)}`;
                        }
                    }
                }
            }
        }
    });

    function updateChart() {
        if (!transactions.length) {
            console.warn("No transaction data available.");
            return;
        }

        const categoryData = {};

        transactions.forEach(transaction => {
            const category = transaction.category;
            const amount = Math.abs(transaction.amount);
            categoryData[category] = (categoryData[category] || 0) + amount;
        });

        categoryChart.data.labels = Object.keys(categoryData);
        categoryChart.data.datasets[0].data = Object.values(categoryData);
        categoryChart.data.datasets[0].backgroundColor = [
            "#0066cc", "#0080ff", "#66b3ff", "#2997ff", "#0056b3",
            "#e0e0e0", "#86868b", "#6c757d", "#003366", "#002b4d"
        ].slice(0, Object.keys(categoryData).length);

        categoryChart.update();
    }

    // Fetch transactions and update the chart
    fetchTransactions();

    // Animate dashboard elements on load
    const elements = document.querySelectorAll('.summary-card, .chart-container, .transactions-container, .reminders-container, .budget-container, .feature-btn');

    elements.forEach((element, index) => {
        setTimeout(() => {
            element.style.opacity = '1';
            element.style.transform = 'translateY(0)';
        }, 100 * index);
    });

});
   document.addEventListener("DOMContentLoaded", async function () {
    async function fetchUpcomingBills() {
        try {
            const response = await fetch("https://my-backend-api-erp6.onrender.com/api/get-upcoming-bills");
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }

            const bills = await response.json();
            displayUpcomingBills(bills);
        } catch (error) {
            console.error("Error fetching upcoming bills:", error);
        }
    }

    function displayUpcomingBills(bills) {
        const billsContainer = document.querySelector(".reminders-list");

        if (!billsContainer) {
            console.error("Reminders container not found!");
            return;
        }

        billsContainer.innerHTML = ""; // Clear existing content

        if (bills.length === 0) {
            billsContainer.innerHTML = "<p>No upcoming bills!</p>";
            return;
        }

        const today = new Date();

        bills.forEach(bill => {
            const dueDate = new Date(bill.deadline); // Correct field name
            const daysUntilDue = Math.ceil((dueDate - today) / (1000 * 60 * 60 * 24));

            // Show only bills scheduled for the future
            if (daysUntilDue >= 0) {
                const billElement = document.createElement("div");
                billElement.classList.add("reminder");
                billElement.innerHTML = `
                    <div class="reminder-date">${dueDate.toLocaleDateString("en-US", { month: "short", day: "numeric" })}</div>
                    <div class="reminder-info">
                        <h4>${bill.description}</h4>
                        <p>$${bill.amount.toFixed(2)}</p>
                    </div>
                    <div class="reminder-status ${daysUntilDue <= 3 ? "due-soon" : ""}">Due in ${daysUntilDue} days</div>
                `;
                billsContainer.appendChild(billElement);
            }
        });

        if (billsContainer.innerHTML === "") {
            billsContainer.innerHTML = "<p>No upcoming bills!</p>";
        }
    }

    fetchUpcomingBills();
});
</script>

</body>
</html>
